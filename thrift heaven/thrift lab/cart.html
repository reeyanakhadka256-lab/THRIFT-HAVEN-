<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Your Cart | Thrift Haven</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <style>
    :root {
      --bg: #f7f1e8;
      --card-bg: #fff9f0;
      --primary: #3a0f14;
      --text-main: #1f2933;
      --text-soft: #6b7280;
      --pill-bg: #fdf7ee;
      --border-subtle: #e5ded3;
      --radius-lg: 20px;
      --radius-pill: 999px;
      --shadow-soft: 0 18px 40px rgba(15, 23, 42, 0.14);
      --font-sans: system-ui, -apple-system, BlinkMacSystemFont, "SF Pro Text",
        "Segoe UI", sans-serif;
      --transition-fast: 150ms ease-out;
    }

    * { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      font-family: var(--font-sans);
      background: radial-gradient(circle at top left, #fcf5eb 0, var(--bg) 42%, #f3ece1 100%);
      color: var(--text-main);
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    a { text-decoration: none; color: inherit; }

    /* HEADER -------------------------------------------------- */

    header {
      width: 100%;
      border-bottom: 1px solid rgba(209, 213, 219, 0.4);
      background: rgba(247, 241, 232, 0.8);
      backdrop-filter: blur(10px);
      position: sticky;
      top: 0;
      z-index: 20;
    }

    .nav-shell {
      max-width: 1120px;
      margin: 0 auto;
      padding: 14px 20px 12px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 20px;
    }

    .nav-left {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .brand-mark {
      width: 32px;
      height: 32px;
      border-radius: 999px;
      background: #111827;
      color: #f9fafb;
      font-size: 13px;
      font-weight: 600;
      letter-spacing: .08em;
      display: inline-flex;
      align-items: center;
      justify-content: center;
    }

    .brand-text-main {
      font-size: 17px;
      font-weight: 600;
      letter-spacing: .05em;
    }

    .nav-links {
      display: flex;
      align-items: center;
      gap: 20px;
      font-size: 14px;
      color: #4b5563;
    }

    .nav-links a {
      position: relative;
      padding-bottom: 3px;
    }

    .nav-links a::after {
      content: "";
      position: absolute;
      left: 0;
      bottom: 0;
      width: 0;
      height: 2px;
      background: var(--primary);
      transition: width var(--transition-fast);
    }

    .nav-links a:hover::after { width: 100%; }

    .nav-right {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .pill-icon {
      border-radius: var(--radius-pill);
      padding: 7px 11px;
      background: var(--pill-bg);
      border: 1px solid rgba(209,213,219,.8);
      font-size: 13px;
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }

    .cart-pill { position: relative; }

    .cart-count {
      position: absolute;
      top: -6px; right: -6px;
      background: var(--primary);
      color: #f9fafb;
      border-radius: 999px;
      padding: 1px 6px;
      font-size: 11px;
      min-width: 18px;
      text-align: center;
    }

    .pill-signin {
      border-radius: var(--radius-pill);
      padding: 8px 18px;
      border: none;
      background: var(--primary);
      color: #f9fafb;
      font-size: 14px;
      cursor: pointer;
      box-shadow: 0 10px 20px rgba(58,15,20,.35);
      transition: transform var(--transition-fast), box-shadow var(--transition-fast),
                  filter var(--transition-fast);
    }

    .pill-signin:hover {
      transform: translateY(-1px);
      filter: brightness(1.03);
      box-shadow: 0 14px 26px rgba(58,15,20,.45);
    }

    main { flex: 1; }

    /* CART LAYOUT -------------------------------------------- */

    .shell {
      max-width: 1120px;
      margin: 0 auto;
      padding: 28px 20px 32px;
    }

    .page-heading h1 {
      font-size: 24px;
      margin-bottom: 4px;
    }

    .page-heading p {
      font-size: 14px;
      color: var(--text-soft);
      max-width: 32rem;
    }

    .cart-layout {
      display: grid;
      grid-template-columns: minmax(0, 1.7fr) minmax(0, 1.3fr);
      gap: 22px;
      margin-top: 22px;
    }

    /* ITEMS CARD --------------------------------------------- */

    .cart-card {
      background: #ffffff;
      border-radius: var(--radius-lg);
      padding: 16px 16px 12px;
      border: 1px solid rgba(229,231,235,.9);
      box-shadow: 0 14px 26px rgba(15,23,42,.05);
    }

    .cart-header {
      display: flex;
      justify-content: space-between;
      align-items: baseline;
      margin-bottom: 10px;
      font-size: 14px;
    }

    .cart-header span {
      font-size: 13px;
      color: var(--text-soft);
    }

    .cart-empty {
      font-size: 14px;
      color: var(--text-soft);
      padding: 12px 0 6px;
    }

    .cart-items {
      margin-top: 8px;
      border-top: 1px solid #e5e7eb;
    }

    .cart-item {
      display: grid;
      grid-template-columns: 80px 1fr auto;
      gap: 14px;
      padding: 12px 0;
      border-bottom: 1px solid #f3f4f6;
      align-items: center;
    }

    .cart-item:last-child { border-bottom: none; }

    .cart-thumb {
      width: 80px;
      height: 80px;
      border-radius: 16px;
      background: linear-gradient(135deg, #e5e7eb, #f9fafb);
    }

    .cart-item-title {
      font-size: 14px;
      font-weight: 500;
      margin-bottom: 4px;
    }

    .cart-item-meta {
      font-size: 12px;
      color: var(--text-soft);
      margin-bottom: 6px;
    }

    .cart-controls {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 12px;
    }

    .qty-btn {
      width: 24px;
      height: 24px;
      border-radius: 999px;
      border: 1px solid #d1d5db;
      background: #f9fafb;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      justify-content: center;
    }

    .qty {
      min-width: 20px;
      text-align: center;
    }

    .remove-btn {
      border: none;
      background: transparent;
      color: #b91c1c;
      cursor: pointer;
      font-size: 12px;
    }

    .cart-item-total {
      font-size: 14px;
      font-weight: 600;
      white-space: nowrap;
    }

    .back-link {
      margin-top: 10px;
      font-size: 13px;
    }
    .back-link a { color: #1d4ed8; }
    .back-link a:hover { text-decoration: underline; }

    /* SUMMARY / ADDRESS / PAYMENT --------------------------- */

    .summary-card {
      background: #ffffff;
      border-radius: var(--radius-lg);
      padding: 16px 16px 14px;
      border: 1px solid rgba(229,231,235,.9);
      box-shadow: 0 14px 26px rgba(15,23,42,.05);
      display: flex;
      flex-direction: column;
      gap: 14px;
    }

    .summary-section-title {
      font-size: 16px;
      margin-bottom: 4px;
    }

    .summary-row {
      display: flex;
      justify-content: space-between;
      font-size: 14px;
      margin-bottom: 4px;
    }

    .summary-row.total {
      margin-top: 6px;
      font-weight: 600;
    }

    .summary-card small {
      font-size: 11px;
      color: var(--text-soft);
    }

    .address-grid {
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 8px 10px;
      margin-top: 6px;
    }

    .form-field {
      font-size: 12px;
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .form-field label { color: #374151; }

    .form-field input {
      padding: 7px 9px;
      border-radius: 9px;
      border: 1px solid var(--border-subtle);
      background: #fffdf9;
      font-size: 13px;
      outline: none;
    }

    .form-field input:focus { border-color: #111827; }

    .payment-options {
      margin-top: 4px;
      display: flex;
      flex-direction: column;
      gap: 6px;
      font-size: 13px;
    }

    .payment-options label {
      display: flex;
      align-items: center;
      gap: 6px;
      cursor: pointer;
    }

    .payment-extra {
      margin-top: 6px;
      font-size: 12px;
      color: var(--text-soft);
      padding: 8px;
      border-radius: 12px;
      background: #f9fafb;
      border: 1px dashed #e5e7eb;
    }

    .summary-actions {
      margin-top: 10px;
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .summary-actions button {
      border-radius: var(--radius-pill);
      padding: 9px 14px;
      font-size: 14px;
      border: none;
      cursor: pointer;
    }

    .btn-buy {
      background: var(--primary);
      color: #f9fafb;
      box-shadow: 0 10px 20px rgba(58,15,20,.35);
      transition: var(--transition-fast);
    }
    .btn-buy:hover {
      transform: translateY(-1px);
      box-shadow: 0 14px 26px rgba(58,15,20,.45);
      filter: brightness(1.03);
    }

    .btn-clear {
      background: #fef9c3;
      color: #92400e;
    }

    /* FOOTER -------------------------------------------------- */

    footer {
      border-top: 1px solid rgba(209, 213, 219, 0.6);
      background: #2c0735;
      color: #f9fafb;
      margin-top: 24px;
    }

    .footer-shell {
      max-width: 1120px;
      margin: 0 auto;
      padding: 16px 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 12px;
      font-size: 13px;
    }

    .footer-links {
      display: flex;
      gap: 16px;
      flex-wrap: wrap;
    }

    .footer-links a {
      color: #e5e7eb;
    }
    .footer-links a:hover { text-decoration: underline; }

    /* RESPONSIVE --------------------------------------------- */

    @media (max-width: 900px) {
      .cart-layout { grid-template-columns: minmax(0, 1fr); }
    }

    @media (max-width: 640px) {
      .nav-shell { flex-wrap: wrap; gap: 10px 14px; }
      .nav-links { display: none; }
      .footer-shell { flex-direction: column; align-items: flex-start; }
      .cart-item {
        grid-template-columns: 70px 1fr;
        grid-template-rows: auto auto;
      }
      .cart-item-total {
        grid-column: 2 / -1;
        justify-self: flex-end;
        margin-top: 4px;
      }
    }
  </style>
</head>
<body>

  <!-- NAVBAR -->
  <header>
    <div class="nav-shell">
      <div class="nav-left">
        <a href="index.html" class="brand-mark">TH</a>
        <div class="brand-text-main">Thrift Haven</div>
      </div>

      <nav class="nav-links" aria-label="Primary">
        <a href="index.html">Home</a>
        <a href="shop.html">Shop</a>
        <a href="about.html">About</a>
        <a href="blog.html">Blog</a>
        <a href="contact.html">Contact</a>
      </nav>

      <div class="nav-right">
        <a href="cart.html" class="pill-icon cart-pill" aria-label="Cart">
          <span>üõí</span>
          <span>Cart</span>
          <span class="cart-count" id="cart-count">0</span>
        </a>
        <a href="signin.html" class="pill-signin">Sign In</a>
      </div>
    </div>
  </header>

  <!-- MAIN -->
  <main>
    <section class="shell">
      <div class="page-heading">
        <h1>Your cart</h1>
        <p>Review your pieces before checking out. Adjust quantities, remove items, and add your delivery details.</p>
      </div>

      <div class="cart-layout">
        <!-- ITEMS -->
        <section class="cart-card">
          <div class="cart-header">
            <h2>Items</h2>
            <span id="items-count">0 items</span>
          </div>

          <div id="cart-items" class="cart-items"></div>
          <p id="empty-message" class="cart-empty" style="display:none;">
            Your cart is currently empty.
          </p>

          <div class="back-link">
            <a href="shop.html">‚Üê Continue shopping</a>
          </div>
        </section>

        <!-- SUMMARY / ADDRESS / PAYMENT -->
        <aside class="summary-card">
          <div>
            <div class="summary-section-title">Order summary</div>
            <div class="summary-row">
              <span>Subtotal</span>
              <span id="subtotal">¬£0.00</span>
            </div>
            <div class="summary-row">
              <span>Shipping</span>
              <span id="shipping">¬£0.00</span>
            </div>
            <div class="summary-row total">
              <span>Total</span>
              <span id="total">¬£0.00</span>
            </div>
            <small>Taxes and shipping are estimated for this checkout.</small>
          </div>

          <div>
            <div class="summary-section-title">Shipping address</div>
            <div class="address-grid">
              <div class="form-field">
                <label for="name">Full name</label>
                <input id="name" type="text" />
              </div>
              <div class="form-field">
                <label for="email">Email</label>
                <input id="email" type="email" />
              </div>
              <div class="form-field">
                <label for="address">Address</label>
                <input id="address" type="text" />
              </div>
              <div class="form-field">
                <label for="city">City</label>
                <input id="city" type="text" />
              </div>
              <div class="form-field">
                <label for="postcode">Postcode</label>
                <input id="postcode" type="text" />
              </div>
              <div class="form-field">
                <label for="country">Country</label>
                <input id="country" type="text" value="United Kingdom" />
              </div>
            </div>
          </div>

          <div>
            <div class="summary-section-title">Payment</div>
            <div class="payment-options">
              <label><input type="radio" name="payment" value="Card" checked /> Card (Visa / Mastercard)</label>
              <label><input type="radio" name="payment" value="Apple Pay" /> Apple Pay</label>
              <label><input type="radio" name="payment" value="PayPal" /> PayPal</label>
            </div>
            <div class="payment-extra" id="payment-extra">
              When you continue, you‚Äôll be redirected to a secure payment gateway for your chosen method.
            </div>
          </div>

          <div class="summary-actions">
            <button class="btn-buy" id="btn-buy">Buy now</button>
            <button class="btn-clear" id="btn-clear">Clear cart</button>
          </div>
        </aside>
      </div>
    </section>
  </main>

  <!-- FOOTER -->
  <footer>
    <div class="footer-shell">
      <div>¬© 2025 Thrift Haven. All rights reserved.</div>
      <div class="footer-links">
        <a href="about.html">About</a>
        <a href="support.html">Support</a>
        <a href="terms.html">Terms</a>
        <a href="privacy.html">Privacy</a>
      </div>
    </div>
  </footer>

  <!-- CART + CHECKOUT LOGIC -->
  <script>
    const CART_KEY = "thriftHavenCart";
    const ORDER_KEY = "thriftHavenLastOrder";

    function getCart() {
      try {
        const raw = localStorage.getItem(CART_KEY);
        if (!raw) return [];
        const arr = JSON.parse(raw);
        if (!Array.isArray(arr)) return [];
        return arr.map(function (item) {
          return {
            id: item.id,
            name: item.name,
            price: Number(item.price) || 0,
            quantity: Number(item.quantity || 0) || 1
          };
        });
      } catch (e) {
        return [];
      }
    }

    function saveCart(cart) {
      localStorage.setItem(CART_KEY, JSON.stringify(cart));
    }

    function updateCartBadge() {
      const cart = getCart();
      const totalQty = cart.reduce(function (sum, item) {
        return sum + item.quantity;
      }, 0);
      var badge = document.getElementById("cart-count");
      if (badge) badge.textContent = totalQty;
    }

    function renderCart() {
      const cart = getCart();
      const listEl = document.getElementById("cart-items");
      const emptyEl = document.getElementById("empty-message");
      const countEl = document.getElementById("items-count");
      const subtotalEl = document.getElementById("subtotal");
      const shippingEl = document.getElementById("shipping");
      const totalEl = document.getElementById("total");

      listEl.innerHTML = "";

      if (!cart.length) {
        emptyEl.style.display = "block";
        countEl.textContent = "0 items";
        subtotalEl.textContent = "¬£0.00";
        shippingEl.textContent = "¬£0.00";
        totalEl.textContent = "¬£0.00";
        return;
      }

      emptyEl.style.display = "none";

      var totalQty = cart.reduce(function (sum, item) {
        return sum + item.quantity;
      }, 0);
      countEl.textContent = totalQty + (totalQty === 1 ? " item" : " items");

      var subtotal = 0;

      cart.forEach(function (item, index) {
        var lineTotal = item.price * item.quantity;
        subtotal += lineTotal;

        var row = document.createElement("div");
        row.className = "cart-item";
        row.innerHTML =
          '<div class="cart-thumb"></div>' +
          '<div>' +
          '<div class="cart-item-title">' + item.name + '</div>' +
          '<div class="cart-item-meta">¬£' + item.price.toFixed(2) + ' each</div>' +
          '<div class="cart-controls">' +
          '<button class="qty-btn" data-action="dec">‚àí</button>' +
          '<span class="qty">' + item.quantity + '</span>' +
          '<button class="qty-btn" data-action="inc">+</button>' +
          '<button class="remove-btn">Remove</button>' +
          '</div>' +
          '</div>' +
          '<div class="cart-item-total">¬£' + lineTotal.toFixed(2) + '</div>';

        var buttons = row.querySelectorAll(".qty-btn");
        var decBtn = buttons[0];
        var incBtn = buttons[1];
        var removeBtn = row.querySelector(".remove-btn");

        decBtn.addEventListener("click", function () {
          var c = getCart();
          c[index].quantity = Math.max(1, c[index].quantity - 1);
          saveCart(c);
          updateCartBadge();
          renderCart();
        });

        incBtn.addEventListener("click", function () {
          var c = getCart();
          c[index].quantity += 1;
          saveCart(c);
          updateCartBadge();
          renderCart();
        });

        removeBtn.addEventListener("click", function () {
          var c = getCart();
          c.splice(index, 1);
          saveCart(c);
          updateCartBadge();
          renderCart();
        });

        listEl.appendChild(row);
      });

      var shipping = subtotal > 0 ? 3.95 : 0;
      var total = subtotal + shipping;

      subtotalEl.textContent = "¬£" + subtotal.toFixed(2);
      shippingEl.textContent = "¬£" + shipping.toFixed(2);
      totalEl.textContent = "¬£" + total.toFixed(2);
    }

    function selectedPayment() {
      var radios = document.querySelectorAll('input[name="payment"]');
      for (var i = 0; i < radios.length; i++) {
        if (radios[i].checked) return radios[i].value;
      }
      return "Card";
    }

    function updatePaymentExtra() {
      var method = selectedPayment();
      var box = document.getElementById("payment-extra");
      if (!box) return;
      if (method === "Card") {
        box.textContent = "You‚Äôll be redirected to a secure card checkout to complete your payment.";
      } else if (method === "Apple Pay") {
        box.textContent = "On supported devices, Apple Pay will appear as a secure payment option.";
      } else {
        box.textContent = "You‚Äôll be redirected to PayPal to review and confirm your order.";
      }
    }

    document.addEventListener("DOMContentLoaded", function () {
      updateCartBadge();
      renderCart();
      updatePaymentExtra();

      var paymentRadios = document.querySelectorAll('input[name="payment"]');
      for (var i = 0; i < paymentRadios.length; i++) {
        paymentRadios[i].addEventListener("change", updatePaymentExtra);
      }

      var buyBtn = document.getElementById("btn-buy");
      var clearBtn = document.getElementById("btn-clear");

      buyBtn.addEventListener("click", function () {
        var cart = getCart();
        if (!cart.length) {
          alert("Your cart is empty.");
          return;
        }

        var name = document.getElementById("name").value.trim();
        var address = document.getElementById("address").value.trim();
        var city = document.getElementById("city").value.trim();
        var postcode = document.getElementById("postcode").value.trim();

        if (!name || !address || !city || !postcode) {
          alert("Please fill in your name, address, city and postcode.");
          return;
        }

        var subtotal = cart.reduce(function (sum, item) {
          return sum + item.price * item.quantity;
        }, 0);
        var shipping = subtotal > 0 ? 3.95 : 0;
        var total = subtotal + shipping;

        var order = {
          orderNumber: "TH-" + Date.now().toString().slice(-6),
          placedAt: new Date().toLocaleString(),
          name: name,
          items: cart,
          subtotal: subtotal,
          shipping: shipping,
          total: total,
          paymentMethod: selectedPayment()
        };

        localStorage.setItem(ORDER_KEY, JSON.stringify(order));

        // clear cart and go to confirmation page
        saveCart([]);
        updateCartBadge();
        window.location.href = "order-confirmation.html";
      });

      clearBtn.addEventListener("click", function () {
        var cart = getCart();
        if (!cart.length) return;
        if (!confirm("Remove all items from your cart?")) return;
        saveCart([]);
        updateCartBadge();
        renderCart();
      });
    });
  </script>
</body>
</html>